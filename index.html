<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/style.css">
  <title>Rakaia Lions Bulbs</title>
</head>

<body>

  <!-- STEP 0: Home Page -->
  <img src="images/hero-image.png" alt="Yellow Strike Lily" class="hero-img">

  <div id="form-step-0">
    <h1>Rakaia Lions Bulbs</h1>
    <h3>2025 selection available now, order today!</h3>
    <button class="primary-btn" id="startOrderBtn">Order Now</button>

    <p>The Rakaia Lions Charitable Trust is proud to offer Lily and Freesia bulbs, generously donated by local bulb
      growers. These growers supply bulbs to commercial flower producers around the world and have chosen to support us.
    </p>

    <p>There are 15 varieties of lilies and 3 varieties of freesias available. Weâ€™re offering these bulbs at retail
      prices to raise funds for our trust:</p>

    <ul>
      <li>Lily Bulbs: $15 per bag (4 bulbs per bag)</li>
      <li>Freesia Bulbs: $7.50 per bag (20 bulbs per bag)</li>
    </ul>

    <p>You can purchase bulbs online via our order form or if you prefer to purchase in person we have a stand outside
      Rakaia Mobil. Orders are processed and sent out each Monday, so be sure to get your order in before 11pm Sunday
      night to make the weekly shipment.</p>

    <p>If you're part of a group or organisation interested in fundraising with our bulbs, weâ€™d love to hear from you.
      While the bulbs are sold here at retail prices, there is an opportunity for approved groups to purchase them at
      wholesale rates. To learn more, please contact the Rakaia Lions Treasurer directly:</p>

    <ul>
      <li>Bruce Kelly</li>
      <li>ðŸ“§ rakaia.treas@lionsclubs.org.nz</li>
      <li>ðŸ“ž 027 437 5040</li>
    </ul>
  </div>

  <!-- STEP 1: Order form -->
  <div id="form-step-1" class="hidden">
    <h2>Order Form</h2>
    <h3><strong>Freesias are not available until 1st September</strong></h3>
    <p>Fill out the form below. Once submitted, youâ€™ll receive a message with our bank transfer details. Please use your
      name as the payment reference.</p>

    <form id="orderFormStep1">
      <div class="product-grid">

        <div class="product-item">
          <img src="images/bellville.png" alt="Belville Lily">
          <label>Belville</label>
          <p class="description">Yellow oriental hybrid lily</p>
          <select name="belville">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/casablanca.png" alt="Casablanca Lily">
          <label>Casablanca</label>
          <p class="description">White oriental lily</p>
          <select name="casablanca">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/concor-dor.png" alt="Concor D'or Lily">
          <label>Concor D'or</label>
          <p class="description">Yellow oriental hybrid lily</p>
          <select name="concorDor">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/kadango.png" alt="Kadango Lily">
          <label>Kadango</label>
          <p class="description">Pink double oriental lily</p>
          <select name="kadango">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/master.png" alt="Master Lily">
          <label>Master</label>
          <p class="description">Pink oriental hybrid lily</p>
          <select name="master">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/pure-passion.png" alt="Pure Passion Lily">
          <label>Pure Passion</label>
          <p class="description">Red oriental hybrid lily</p>
          <select name="purePassion">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/red-eyes.png" alt="Red Eyes">
          <label>Red Eyes</label>
          <p class="description">Red oriental lily</p>
          <select name="redEyes">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/redford.png" alt="Redford Lily">
          <label>Redford Lily</label>
          <p class="description">Red oriental hybrid lily</p>
          <select name="redford">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/shine-on.png" alt="Shine On Lily">
          <label>Shine On</label>
          <p class="description">Apricot oriental lily</p>
          <select name="shineOn">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/siberia.png" alt="Siberia Lily">
          <label>Siberia</label>
          <p class="description">White oriental</p>
          <select name="siberia">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/sorbonne.png" alt="Sorbonne Lily">
          <label>Sorbonne</label>
          <p class="description">Pink oriental lily</p>
          <select name="sorbonne">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/table-dance.png" alt="Table Dance Lily">
          <label>Table Dance</label>
          <p class="description">Pink oriental hybrid lily</p>
          <select name="tableDance">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/tisento.png" alt="Tisento Lily">
          <label>Tisento</label>
          <p class="description">White oriental hybrid lily</p>
          <select name="tisento">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/white-tornado.png" alt="White Tornado Lily">
          <label>White Tornado</label>
          <p class="description">White double oriental lily</p>
          <select name="whiteTornado">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>
      </div>

      <div class="product-item">
        <img src="images/yellow-strike.png" alt="Yellow Strike Lily">
        <label>Yellow Strike Lily</label>
        <p class="description">Yellow oriental hybrid lily</p>
        <select name="yellowStrike">
          <option value="0">Quantity</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
          <option value="6">6</option>
          <option value="7">7</option>
          <option value="8">8</option>
          <option value="9">9</option>
          <option value="10">10</option>
        </select>
      </div>
  </div>

  <div class="nav-buttons">
    <div class="left-button">
      <button type="button" id="prevToStep0Btn">Previous</button>
    </div>
    <div class="right-button">
      <button type="button" class="primary-btn" id="nextToStep2Btn">Next</button>
    </div>
  </div>
  </form>
  </div>

  <!-- STEP 2: Customer details -->
  <div id="form-step-2" class="hidden">
    <h2>Customer Information</h2>

    <form id="orderFormStep2">
      <label>First Name</label>
      <input type="text" name="firstName" required />

      <label>Last Name</label>
      <input type="text" name="lastName" required />

      <label>Email</label>
      <input type="email" name="email" required />

      <label>Phone Number</label>
      <input type="text" name="phone" required />

      <h2 class="shipping">Shipping Information</h2>

      <label>Street Address</label>
      <input type="text" name="address" required />

      <label>Apartment, unit (optional)</label>
      <input type="text" name="unit" />

      <label>Town/City</label>
      <input type="text" name="city" required />

      <label>Postal Code</label>
      <input type="text" name="postcode" required />

      <input type="hidden" name="total" id="totalField">

      <input type="hidden" name="order" id="orderField">

      <div id="order-summary" class="order-summary">
        <h3>Your Order</h3>
        <ul id="order-items"></ul>
        <p><strong>Total: $<span id="order-total">0.00</span></strong></p>
      </div>

      <div class="nav-buttons">
        <div class="left-button">
          <button type="button" id="prevBtn">Previous</button>
        </div>
        <div class="right-button">
          <button type="submit" class="primary-btn">Submit</button>
        </div>
      </div>
    </form>
  </div>

  <!-- STEP 3: Thank you message -->
  <div id="form-step-3" class="hidden">
    <h2>Thank you for your order!</h2>
    <p id="thankYouMessage">Your order has been received. Please transfer your total amount of <strong
        id="finalAmount">$0.00</strong>
      to:</p>
    <p>Bank Account Name: Rakaia Lions</p>
    <p>Bank Account Number: 03 1354 0432008 00</p>
    <p>Reference: Your Full Name</p>
    <p>You will also receive a confirmation email shortly.</p>
  </div>

  <footer>
    <img src="images/LCI_emblem_2color_web.png" alt="Lions Club International Emblem">
    <p>&copy; Rakaia Lions Club 2025</p>
  </footer>

  <!-- JS Script -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <script>
    emailjs.init("6URWzvPDCKvplKWVm");

    const steps = {
      0: document.getElementById('form-step-0'),
      1: document.getElementById('form-step-1'),
      2: document.getElementById('form-step-2'),
      3: document.getElementById('form-step-3'),
    };

    const orderItemsList = document.getElementById('order-items');
    const orderTotalEl = document.getElementById('order-total');
    const finalAmountEl = document.getElementById('finalAmount');

    const prices = {
      tisento: 15,
      bellville: 15,
      redford: 15,
      yellowStrike: 15,
      sorbonne: 15,
      siberia: 15,
      purePassion: 15,
      master: 15,
      concorDor: 15,
      whiteTornado: 15,
      tableDance: 15,
      shineOn: 15,
      redEyes: 15,
      kadango: 15,
      casablanca: 15,
    };

    function showStep(stepToShow) {
      Object.values(steps).forEach(step => step.classList.add('hidden'));
      steps[stepToShow].classList.remove('hidden');

      const navButtons = document.querySelectorAll('.nav-buttons');
      navButtons.forEach(nav => {
        nav.style.display = stepToShow === 0 ? 'none' : 'flex';
      });
    }

    document.getElementById('startOrderBtn').addEventListener('click', () => showStep(1));
    document.getElementById('prevToStep0Btn').addEventListener('click', () => showStep(0));
    document.getElementById('prevBtn').addEventListener('click', () => showStep(1));

    document.getElementById('nextToStep2Btn').addEventListener('click', () => {
      try {
        const formData = new FormData(document.getElementById('orderFormStep1'));
        orderItemsList.innerHTML = '';
        let total = 0;
        let totalQuantity = 0;

        // List ordered items
        for (const [name, qty] of formData.entries()) {
          const quantity = parseInt(qty);
          if (quantity > 0 && prices[name]) {
            const itemTotal = quantity * prices[name];
            total += itemTotal;
            totalQuantity += quantity;

            const label = document.querySelector(`select[name="${name}"]`).previousElementSibling.textContent;
            const li = document.createElement('li');
            li.textContent = `${label}: ${quantity} Ã— $${prices[name].toFixed(2)} = $${itemTotal.toFixed(2)}`;
            orderItemsList.appendChild(li);
          }
        }

        // Calculate delivery cost based on quantity
        let deliveryCost = 0;
        if (total > 0 && total <= 60) deliveryCost = 8.00;
        else if (total <= 120) deliveryCost = 10.00;
        else deliveryCost = 12.00;

        // Show delivery cost
        if (deliveryCost > 0) {
          const deliveryLi = document.createElement('li');
          deliveryLi.textContent = `Delivery Cost: $${deliveryCost.toFixed(2)}`;
          orderItemsList.appendChild(deliveryLi);
        }

        total += deliveryCost;
        orderTotalEl.textContent = total.toFixed(2);

        showStep(2);

      } catch (err) {
        alert("There was an error processing your order. Please try again.");
        console.error(err);
      }
    });

    document.getElementById('orderFormStep2').addEventListener('submit', async (event) => {
      event.preventDefault();

      try {
        const form = event.target;

        // Create order summary text
        const orderSummary = Array.from(orderItemsList.querySelectorAll('li'))
          .map(li => li.textContent)
          .join('\n');

        document.getElementById('orderField').value = orderSummary;
        document.getElementById('totalField').value = orderTotalEl.textContent;

        // Combine first name and last name into full_name
        const firstName = form.querySelector('[name="firstName"]').value;
        const lastName = form.querySelector('[name="lastName"]').value;
        const fullName = `${firstName} ${lastName}`;

        // Set the full_name field value
        let fullNameField = form.querySelector('[name="full_name"]');
        if (!fullNameField) {
          fullNameField = document.createElement('input');
          fullNameField.type = 'hidden';
          fullNameField.name = 'full_name';
          form.appendChild(fullNameField);
        }
        fullNameField.value = fullName;

        // Send confirmation to customer
        await emailjs.sendForm(
          "service_ysispk8", "template_b8g295h", form,
          "6URWzvPDCKvplKWVm" // Public key
        );

        // Send order details to owner
        await emailjs.sendForm(
          "service_ysispk8", "template_nzusrii", form,
          "6URWzvPDCKvplKWVm" // Public key
        );

        showStep(3);
        finalAmountEl.textContent = orderTotalEl.textContent;

      } catch (error) {
        alert("There was an error submitting your order. Please try again.");
        console.error(error);
      }
    });
  </script>
</body>

</html>
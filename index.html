<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/style.css">
  <title>Rakaia Lions Bulbs</title>
</head>

<body>

  <!-- STEP 0: Home Page -->
  <img src="images/hero-image.png" alt="Yellow Strike Lily" class="hero-img">

  <div id="form-step-0">
    <h1>Rakaia Lions Bulbs</h1>
    <h3>2025 selection available now, order today!</h3>
    <button class="primary-btn" id="startOrderBtn">Order Now</button>

    <p>The Rakaia Lions Charitable Trust is proud to offer Lily and Freesia bulbs, generously donated by local bulb
      growers. These growers supply bulbs to commercial flower producers around the world and have chosen to support us.
    </p>

    <p>There are 15 varieties of lilies and 3 varieties of freesias available. Weâ€™re offering these bulbs at retail
      prices to raise funds for our trust:</p>

    <ul>
      <li>Lily Bulbs: $15 per bag (4 bulbs per bag)</li>
      <li>Freesia Bulbs: $7.50 per bag (20 bulbs per bag)</li>
    </ul>

    <p>You can purchase bulbs online via our order form or if you prefer to purchase in person we have a stand outside
      Rakaia Mobil. Orders are processed and sent out each Monday, so be sure to get your order in before 11pm Sunday
      night to make the weekly shipment.</p>

    <p>If you're part of a group or organisation interested in fundraising with our bulbs, weâ€™d love to hear from you.
      While the bulbs are sold here at retail prices, there is an opportunity for approved groups to purchase them at
      wholesale rates. To learn more, please contact the Rakaia Lions Treasurer directly:</p>

    <ul>
      <li>Bruce Kelly</li>
      <li>ðŸ“§ rakaia.treas@lionsclubs.org.nz</li>
      <li>ðŸ“ž 027 437 5040</li>
    </ul>
  </div>

  <!-- STEP 1: Order form -->
  <div id="form-step-1" class="hidden">
    <h2>Order Form</h2>
    <h3><strong>Freesias are not available until 1st September</strong></h3>
    <p>Fill out the form below. Once submitted, youâ€™ll receive a message with our bank transfer details. Please use your
      name as the payment reference.</p>

    <form id="orderFormStep1">
      <div class="product-grid">

        <div class="product-item">
          <img src="images/bellville.png" alt="Belville Lily">
          <label>Belville</label>
          <p class="description">Yellow oriental hybrid lily</p>
          <select name="belville">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/casablanca.png" alt="Casablanca Lily">
          <label>Casablanca</label>
          <p class="description">White oriental lily</p>
          <select name="casablanca">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/concor-dor.png" alt="Concor D'or Lily">
          <label>Concor D'or</label>
          <p class="description">Yellow oriental hybrid lily</p>
          <select name="concorDor">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/kadango.png" alt="Kadango Lily">
          <label>Kadango</label>
          <p class="description">Pink double oriental lily</p>
          <select name="kadango">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/master.png" alt="Master Lily">
          <label>Master</label>
          <p class="description">Pink oriental hybrid lily</p>
          <select name="master">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/pure-passion.png" alt="Pure Passion Lily">
          <label>Pure Passion</label>
          <p class="description">Red oriental hybrid lily</p>
          <select name="purePassion">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/red-eyes.png" alt="Red Eyes">
          <label>Red Eyes</label>
          <p class="description">Red oriental lily</p>
          <select name="redEyes">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/redford.png" alt="Redford Lily">
          <label>Redford Lily</label>
          <p class="description">Red oriental hybrid lily</p>
          <select name="redford">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/shine-on.png" alt="Shine On Lily">
          <label>Shine On</label>
          <p class="description">Apricot oriental lily</p>
          <select name="shineOn">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/siberia.png" alt="Siberia Lily">
          <label>Siberia</label>
          <p class="description">White oriental</p>
          <select name="siberia">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/sorbonne.png" alt="Sorbonne Lily">
          <label>Sorbonne</label>
          <p class="description">Pink oriental lily</p>
          <select name="sorbonne">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/table-dance.png" alt="Table Dance Lily">
          <label>Table Dance</label>
          <p class="description">Pink oriental hybrid lily</p>
          <select name="tableDance">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/tisento.png" alt="Tisento Lily">
          <label>Tisento</label>
          <p class="description">White oriental hybrid lily</p>
          <select name="tisento">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/white-tornado.png" alt="White Tornado Lily">
          <label>White Tornado</label>
          <p class="description">White double oriental lily</p>
          <select name="whiteTornado">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="product-item">
          <img src="images/yellow-strike.png" alt="Yellow Strike Lily">
          <label>Yellow Strike Lily</label>
          <p class="description">Yellow oriental hybrid lily</p>
          <select name="yellowStrike">
            <option value="0">Quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
          </select>
        </div>
      </div>
    </form>
  </div>

  <!-- STEP 2: Customer details -->
  <div id="form-step-2" class="hidden">
    <h2>Customer Information</h2>

    <form id="orderFormStep2">
      <label>First Name</label>
      <input type="text" name="firstName" required />

      <label>Last Name</label>
      <input type="text" name="lastName" required />

      <label>Email</label>
      <input type="email" name="email" required />

      <label>Phone Number</label>
      <input type="text" name="phone" required />

      <h2 class="shipping">Shipping Information</h2>

      <label>Street Address</label>
      <input type="text" name="address" required />

      <label>Apartment, unit (optional)</label>
      <input type="text" name="unit" />

      <label>Town/City</label>
      <input type="text" name="city" required />

      <label>Postal Code</label>
      <input type="text" name="postcode" required />

      <input type="hidden" name="total" id="totalField">

      <input type="hidden" name="order" id="orderField">

      <div id="order-summary" class="order-summary">
        <h3>Your Order</h3>
        <ul id="order-items"></ul>
        <p><strong>Total: $<span id="order-total">0.00</span></strong></p>
      </div>
    </form>
  </div>

  <!-- STEP 3: Thank you message -->
  <div id="form-step-3" class="hidden">
    <h2>Thank you for your order!</h2>
    <p id="thankYouMessage">Your order has been received. Please transfer your total amount of <strong
        id="finalAmount">$0.00</strong>
      to:</p>
    <p>Bank Account Name: Rakaia Lions</p>
    <p>Bank Account Number: 03 1354 0432008 00</p>
    <p>Reference: Your Full Name</p>
    <p>You will also receive a confirmation email shortly.</p>
  </div>

  <div class="nav-buttons hidden" id="navButtons">
    <button id="prevBtn" type="button">Previous</button>
    <button id="nextBtn" type="button" class="primary-btn">Next</button>
    <button id="submitBtn" type="submit" class="primary-btn hidden">Submit</button>
  </div>

  <footer>
    <img src="images/LCI_emblem_2color_web.png" alt="Lions Club International Emblem">
    <p>&copy; Rakaia Lions Club 2025</p>
  </footer>



  <!-- JS Script -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
    emailjs.init("6URWzvPDCKvplKWVm");

    const steps = {
      0: document.getElementById('form-step-0'),
      1: document.getElementById('form-step-1'),
      2: document.getElementById('form-step-2'),
      3: document.getElementById('form-step-3'),
    };

    // Cached DOM elements for order summary
    const orderItemsList = document.getElementById('order-items');
    const orderTotalEl = document.getElementById('order-total');
    const finalAmountEl = document.getElementById('finalAmount');

    // Navigation buttons container and buttons
    const navButtonsContainer = document.getElementById('navButtons');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const submitBtn = document.getElementById('submitBtn');

    // Prices for each product - corrected "belville" to match HTML
    const prices = {
      tisento: 15,
      belville: 15, // Fixed spelling to match HTML
      redford: 15,
      yellowStrike: 15,
      sorbonne: 15,
      siberia: 15,
      purePassion: 15,
      master: 15,
      concorDor: 15,
      whiteTornado: 15,
      tableDance: 15,
      shineOn: 15,
      redEyes: 15,
      kadango: 15,
      casablanca: 15,
    };

    // Current step tracker
    let currentStep = 0;

    // Function to show a particular step and update nav buttons visibility
    function showStep(stepToShow) {
      // Hide all steps
      Object.values(steps).forEach(step => {
        if (step) step.classList.add('hidden');
      });

      // Show requested step
      if (steps[stepToShow]) {
        steps[stepToShow].classList.remove('hidden');
        currentStep = stepToShow;
      }

      // Control nav buttons visibility based on step
      if (navButtonsContainer) {
        if (stepToShow === 0 || stepToShow === 3) {
          // Hide nav buttons on step 0 and 3
          navButtonsContainer.classList.add('hidden');
        } else {
          // Show nav buttons on steps 1 and 2
          navButtonsContainer.classList.remove('hidden');

          if (stepToShow === 1) {
            // Step 1: Show Previous + Next, hide Submit
            if (prevBtn) prevBtn.style.display = 'inline-block';
            if (nextBtn) nextBtn.style.display = 'inline-block';
            if (submitBtn) submitBtn.style.display = 'none';
          } else if (stepToShow === 2) {
            // Step 2: Show Previous + Submit, hide Next
            if (prevBtn) prevBtn.style.display = 'inline-block';
            if (nextBtn) nextBtn.style.display = 'none';
            if (submitBtn) submitBtn.style.display = 'inline-block';
          }
        }
      }
    }

    // Initialize - show step 0
    showStep(0);

    // Event listeners for buttons

    // Start ordering: step 0 -> step 1
    const startOrderBtn = document.getElementById('startOrderBtn');
    if (startOrderBtn) {
      startOrderBtn.addEventListener('click', () => {
        console.log('Start Order button clicked');
        showStep(1);
      });
    }

    // Previous button behavior
    if (prevBtn) {
      prevBtn.addEventListener('click', () => {
        console.log('Previous button clicked, current step:', currentStep);
        if (currentStep === 2) {
          showStep(1);
        } else if (currentStep === 1) {
          showStep(0);
        }
      });
    }

    // Next button behavior (step 1 -> 2)
    if (nextBtn) {
      nextBtn.addEventListener('click', () => {
        console.log('Next button clicked');

        if (currentStep === 1) {
          try {
            const form = document.getElementById('orderFormStep1');
            if (!form) {
              console.error('orderFormStep1 not found');
              return;
            }

            const formData = new FormData(form);

            // Clear previous order summary
            if (orderItemsList) orderItemsList.innerHTML = '';

            let total = 0;
            let totalQuantity = 0;
            let hasItems = false;

            // Process each form field
            for (const [name, qty] of formData.entries()) {
              const quantity = parseInt(qty);
              if (quantity > 0 && prices[name]) {
                hasItems = true;
                const itemTotal = quantity * prices[name];
                total += itemTotal;
                totalQuantity += quantity;

                // Get the product name from the label
                const selectEl = document.querySelector(`select[name="${name}"]`);
                let label = name;
                if (selectEl) {
                  const labelEl = selectEl.closest('.product-item').querySelector('label');
                  if (labelEl) label = labelEl.textContent;
                }

                // Add item to order summary
                if (orderItemsList) {
                  const li = document.createElement('li');
                  li.textContent = `${label}: ${quantity} Ã— $${prices[name].toFixed(2)} = $${itemTotal.toFixed(2)}`;
                  orderItemsList.appendChild(li);
                }
              }
            }

            // Calculate delivery cost based on total
            let deliveryCost = 0;
            if (total > 0 && total <= 60) deliveryCost = 8.00;
            else if (total > 60 && total <= 120) deliveryCost = 10.00;
            else if (total > 120) deliveryCost = 12.00;

            // Add delivery cost to order list
            if (deliveryCost > 0 && orderItemsList) {
              const deliveryLi = document.createElement('li');
              deliveryLi.textContent = `Delivery Cost: $${deliveryCost.toFixed(2)}`;
              orderItemsList.appendChild(deliveryLi);
            }

            // Update total
            total += deliveryCost;
            if (orderTotalEl) orderTotalEl.textContent = total.toFixed(2);

            console.log('Order processed, total:', total);

            // Proceed to step 2
            showStep(2);

          } catch (err) {
            console.error('Error processing order:', err);
            alert("There was an error processing your order. Please try again.");
          }
        }
      });
    }

    // Submit button behavior
    if (submitBtn) {
      submitBtn.addEventListener('click', async (event) => {
        event.preventDefault();
        console.log('Submit button clicked');

        try {
          const form = document.getElementById('orderFormStep2');
          if (!form) {
            console.error('orderFormStep2 not found');
            return;
          }

          // Build order summary text
          let orderSummary = '';
          if (orderItemsList) {
            orderSummary = Array.from(orderItemsList.querySelectorAll('li'))
              .map(li => li.textContent)
              .join('\n');
          }

          // Set hidden fields
          const orderField = document.getElementById('orderField');
          const totalField = document.getElementById('totalField');
          if (orderField) orderField.value = orderSummary;
          if (totalField && orderTotalEl) totalField.value = orderTotalEl.textContent;

          // Combine first and last name for full_name hidden field
          const firstName = form.querySelector('[name="firstName"]')?.value.trim() || '';
          const lastName = form.querySelector('[name="lastName"]')?.value.trim() || '';
          const fullName = `${firstName} ${lastName}`.trim();

          let fullNameField = form.querySelector('[name="full_name"]');
          if (!fullNameField) {
            fullNameField = document.createElement('input');
            fullNameField.type = 'hidden';
            fullNameField.name = 'full_name';
            form.appendChild(fullNameField);
          }
          fullNameField.value = fullName;

          // Send confirmation email to customer
          await emailjs.sendForm(
            "service_ysispk8",
            "template_b8g295h",
            form,
            "6URWzvPDCKvplKWVm"
          );

          // Send order details to owner
          await emailjs.sendForm(
            "service_ysispk8",
            "template_nzusrii",
            form,
            "6URWzvPDCKvplKWVm"
          );

          // Show thank you step and final amount
          if (finalAmountEl && orderTotalEl) {
            finalAmountEl.textContent = '$' + orderTotalEl.textContent;
          }
          showStep(3);

        } catch (error) {
          console.error('Error submitting form:', error);
          alert("There was an error submitting your order. Please try again.");
        }
      });
    }
  });
  </script>

</body>

</html>